# Ejercicio 1: Usar imagen en vez de build
# Antes de usar este archivo, debes:
# 1. Construir la imagen: docker build -t <tu-usuario>/friendlyhello .
# 2. Subir la imagen: docker push <tu-usuario>/friendlyhello
# 3. Reemplazar <tu-usuario> en este archivo con tu usuario de Docker Hub

services:
    web:
        image: <tu-usuario>/friendlyhello
        labels:
        - "traefik.enable=true"
        - "traefik.http.routers.web.rule=Host(`localhost`)"
        - "traefik.http.routers.web.entrypoints=web"
        - "traefik.http.services.web.loadbalancer.server.port=80"
    redis:
        image: redis
        volumes:
            - "./data:/data"
        command: redis-server --appendonly yes
        labels:
        - "traefik.enable=false"
    traefik:
        image: traefik:v2.3
        command:
        - "--log.level=DEBUG"
        - "--api.insecure=true"
        - "--providers.docker=true"
        - "--providers.docker.exposedByDefault=false"
        - "--entrypoints.web.address=:4000"
        ports:
        - "4000:4000"
        - "8080:8080"
        volumes:
        - "/var/run/docker.sock:/var/run/docker.sock"
        labels:
        - "traefik.enable=true"
